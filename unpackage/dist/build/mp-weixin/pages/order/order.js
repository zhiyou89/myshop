(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"1d99":function(t,e,a){"use strict";a.r(e);var n=a("6398"),r=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=r.a},"2a4c":function(t,e,a){"use strict";(function(t){a("ffa8");n(a("66fd"));var e=n(a("54fc"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"54fc":function(t,e,a){"use strict";a.r(e);var n=a("dc51"),r=a("1d99");for(var o in r)"default"!==o&&function(t){a.d(e,t,(function(){return r[t]}))}(o);a("a169");var s,i=a("f0c5"),u=Object(i["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=u.exports},6398:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(a("a34a"));function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,a,n,r,o,s){try{var i=t[o](s),u=i.value}catch(c){return void a(c)}i.done?e(u):Promise.resolve(u).then(n,r)}function s(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){o(s,n,r,i,u,"next",t)}function u(t){o(s,n,r,i,u,"throw",t)}i(void 0)}))}}var i=function(){Promise.all([a.e("common/vendor"),a.e("components/uni-icons/uni-icons")]).then(function(){return resolve(a("f812"))}.bind(null,a)).catch(a.oe)},u={data:function(){return{orderData:[],orderInfo:[],orderStatus:1,classActive:!1,flash:!1,statusText:[{id:1,text:"待付款"},{id:2,text:"已付款"},{id:3,text:"已完成"},{id:4,text:"退款/售后"},{id:10,text:"全部"}]}},components:{uniIcons:i},methods:{jumpTo:function(e){t.navigateTo({url:"/pages/reviews/reviews?id="+e})},cancel:function(e){t.showModal({content:"您要取消订单吗",success:function(a){a.confirm&&t.request({url:"https://www.yjcloudcomputing.com/api/v1/order/cancel",data:{id:e},success:function(e){200==e.data.status&&t.showToast({title:e.data.msg,success:function(e){setTimeout((function(){t.switchTab({url:"/pages/about-us/about-us"})}),1e3)}})}})}})},_isHasThatOne:function(t,e){for(var a,n={index:-1},r=0;r<e.length;r++)if(a=e[r],a.id==t){n={index:r,data:a};break}return n},delete:function(e){e instanceof Array||(e=[e]);for(var a=t.getStorageSync(data.storageKeyForCart),n=0;n<e.length;n++){var r=this._isHasThatOne(e[n].id,a);-1!=r.index&&a.splice(r.index,1)}t.setStorageSync(data.storageKeyForCart,a)},payOneTime:function(e){var a=this;return s(n.default.mark((function r(){var o,s;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.$myrequest({url:"/pay/pre_order",method:"POST",data:{id:e}});case 2:o=n.sent,o.nonceStr&&o.paySign&&o.package&&(s=a,t.requestPayment({provider:"wxpay",timeStamp:o.timeStamp.toString(),nonceStr:o.nonceStr,package:o.package,signType:o.signType,paySign:o.paySign,success:function(t){if(console.log(t),"requestPayment:ok"==t.errMsg){s.delete(s.productArr);placeOrderInfo.order_id}},fail:function(e){console.log("fail:"+JSON.stringify(e)),t.showToast({title:"付款失败",icon:"none"})}}));case 4:case"end":return n.stop()}}),r)})))()},intOrderData:function(t){this.isHas(t)||this.orderData.push({page:1,status:t,flash:!1,data:[]})},editPage:function(t,e){for(var a=0;this.orderData.length>a;a++)this.orderData[a].status==t&&(this.orderData[a].page=e)},editFlash:function(t,e){for(var a=0;this.orderData.length>a;a++)this.orderData[a].status==t&&(this.orderData[a].flash=e)},isHasDataByStatus:function(t){for(var e=0;this.orderData.length>e;e++)if(this.orderData[e].status==t)return this.orderData[e].data.length},isHas:function(t){for(var e=0;this.orderData.length>e;e++)if(this.orderData[e].status==t)return!0},getPage:function(t){for(var e=1,a=0;this.orderData.length>a;a++)if(this.orderData[a].status==t)return this.orderData[a].page;return e},getFlash:function(t){for(var e=!1,a=0;this.orderData.length>a;a++)if(this.orderData[a].status==t)return this.orderData[a].flash;return e},pushData:function(t,e){!t instanceof Array&&(t=[t]);for(var a=0;this.orderData.length>a;a++)if(this.orderData[a].status==e)for(var n=0;t.length>n;n++)this.orderData[a].data.push(t[n])},getSowData:function(t){for(var e=0;this.orderData.length>e;e++)this.orderData[e].status==t&&(this.orderInfo=this.orderData[e].data)},getOrderByStaus:function(t,e){var a=this;return s(n.default.mark((function r(){var o;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.$myrequest({url:"/order/all",data:{page:e,status:t}});case 2:o=n.sent,(!o.data.length||o.data.length<10)&&a.editFlash(t,!0),a.pushData(o.data,t),a.getSowData(t);case 6:case"end":return n.stop()}}),r)})))()},getOrderStaus:function(t){this.orderStatus=t,this.intOrderData(t);var e=this.getPage(t),a=this.isHasDataByStatus(t);a?this.getSowData(t):this.getOrderByStaus(t,e)},navigate_to:function(e){t.navigateTo({url:e})}},onLoad:function(t){this.orderStatus=t.status,this.intOrderData(t.status),this.getOrderByStaus(t.status,1)},onReachBottom:function(){if(!this.getFlash(this.orderStatus)){var t=this.getPage(this.orderStatus);t++,console.log(t),this.editPage(this.orderStatus,t),this.getOrderByStaus(this.orderStatus,t)}console.log(this.orderData)},onHide:function(){console.log("onhide")},onShow:function(){console.log("onshow")}};e.default=u}).call(this,a("543d")["default"])},a169:function(t,e,a){"use strict";var n=a("e1e4"),r=a.n(n);r.a},dc51:function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var n={uniIcons:function(){return Promise.all([a.e("common/vendor"),a.e("components/uni-icons/uni-icons")]).then(a.bind(null,"f812"))}},r=function(){var t=this,e=t.$createElement;t._self._c},o=[]},e1e4:function(t,e,a){}},[["2a4c","common/runtime","common/vendor"]]]);